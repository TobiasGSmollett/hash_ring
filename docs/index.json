{"repository_name":"github.com/TobiasGSmollett/hash_ring","body":"# hash_ring\nThe Consistent Hash Ring is a useful data structure when you operate the distributed servers. This library is implementation of Consistent Hash Ring based on the excellent [Elixir hash ring lib](https://github.com/discordapp/ex_hash_ring).\n\n## Installation\n\nAdd this to your application's `shard.yml`:\n\n```yaml\ndependencies:\n  hash_ring:\n    github: TobiasGSmollett/hash_ring\n```\n\n## Usage\n\n```crystal\nrequire \"hash_ring\"\n\n# Register 3 servers\nhash_ring = HashRing::HashRing.new([\"one\", \"two\", \"three\"])\n\n# Every user is assigned a server by consistent hash ring.\nhash_ring.get(\"user1\") # => \"three\"\nhash_ring.get(\"user2\") # => \"three\"\nhash_ring.get(\"user3\") # => \"one\"\nhash_ring.get(\"user4\") # => \"two\"\n\n# Removes the \"two\" server\nhash_ring.remove(\"two\")\n\n# Exists two servers which are \"one\" and \"three\".\nhash_ring.get(\"user1\") # => \"three\"\nhash_ring.get(\"user2\") # => \"three\"\nhash_ring.get(\"user3\") # => \"one\"\nhash_ring.get(\"user4\") # => \"three\"\n```\n\n## Contributing\n\n1. Fork it ( https://github.com/TobiasGSmollett/hash_ring/fork )\n2. Create your feature branch (git checkout -b my-new-feature)\n3. Commit your changes (git commit -am 'Add some feature')\n4. Push to the branch (git push origin my-new-feature)\n5. Create a new Pull Request\n\n## Contributors\n\n- [tobias](https://github.com/TobiasGSmollett) TobiasGSmollett - creator, maintainer\n","program":{"html_id":"github.com/TobiasGSmollett/hash_ring/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"github.com/TobiasGSmollett/hash_ring","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing","path":"HashRing.html","kind":"module","full_name":"HashRing","name":"HashRing","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"hash_ring/utils.cr","line_number":4,"url":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/utils.cr"},{"filename":"hash_ring/item.cr","line_number":3,"url":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr"},{"filename":"hash_ring/version.cr","line_number":1,"url":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/version.cr"},{"filename":"hash_ring.cr","line_number":3,"url":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr"}],"repository_name":"github.com/TobiasGSmollett/hash_ring","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"name":"VERSION","value":"\"0.2.0\"","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing/Utils","kind":"module","full_name":"HashRing::Utils","name":"Utils"}],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing/HashRing","path":"HashRing/HashRing.html","kind":"class","full_name":"HashRing::HashRing","name":"HashRing","abstract":false,"superclass":{"html_id":"github.com/TobiasGSmollett/hash_ring/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/TobiasGSmollett/hash_ring/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/TobiasGSmollett/hash_ring/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"hash_ring.cr","line_number":4,"url":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr"}],"repository_name":"github.com/TobiasGSmollett/hash_ring","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing","kind":"module","full_name":"HashRing","name":"HashRing"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(nodes,replicate=512)-class-method","html_id":"new(nodes,replicate=512)-class-method","name":"new","doc":"Initializes HashRing\nnodes is an array of node name and replicate is number of each node in the hash ring array.\n\n```\nHashRing::HashRing.new([\"node1\", \"node2\", \"node3\"])\n```","summary":"<p>Initializes HashRing nodes is an array of node name and replicate is number of each node in the hash ring array.</p>","abstract":false,"args":[{"name":"nodes","doc":null,"default_value":"","external_name":"nodes","restriction":""},{"name":"replicate","doc":null,"default_value":"512","external_name":"replicate","restriction":""}],"args_string":"(nodes, replicate = <span class=\"n\">512</span>)","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L15","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L15","def":{"name":"new","args":[{"name":"nodes","doc":null,"default_value":"","external_name":"nodes","restriction":""},{"name":"replicate","doc":null,"default_value":"512","external_name":"replicate","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(nodes, replicate)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"add(node:String):Bool-instance-method","html_id":"add(node:String):Bool-instance-method","name":"add","doc":"Appends a node to tail of the hash ring array.\nTime complexity of this method is O(n log n) because sort the hash ring array whenever call this method.\n\n```\nhash_ring = HashRing::Hashring.new([\"node1\", \"node2\", \"node3\"])\nhash_ring.add(\"node4\")\n```","summary":"<p>Appends a node to tail of the hash ring array.</p>","abstract":false,"args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"String"}],"args_string":"(node : String) : Bool","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L26","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L26","def":{"name":"add","args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"if @nodes.any? do |e|\n  e == node\nend\n  return false\nend\n@nodes << node\n@items = generate_items(@nodes, @replicate)\ntrue\n"}},{"id":"get(node:String):String-instance-method","html_id":"get(node:String):String-instance-method","name":"get","doc":"Returns a node name.\n\n```\nhash_ring = HashRing::Hashring.new([\"node1\", \"node2\", \"node3\"])\nhash_ring.get(\"user1\") # => \"node3\"\n```","summary":"<p>Returns a node name.</p>","abstract":false,"args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"String"}],"args_string":"(node : String) : String","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L53","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L53","def":{"name":"get","args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"if @items.last.hash < (Utils.hash(node))\n  return @items.last.node\nend\n@items[find_item_index(node)].node\n"}},{"id":"remove(node:String):Bool-instance-method","html_id":"remove(node:String):Bool-instance-method","name":"remove","doc":"Removes node by a node name from the hash ring array.\nTime complexity of this method is O(n log n) because sort the hash ring array whenever call this method.\n\n```\nhash_ring = HashRing::Hashring.new([\"node1\", \"node2\", \"node3\"])\nhash_ring.remove(\"node4\")\n```","summary":"<p>Removes node by a node name from the hash ring array.</p>","abstract":false,"args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"String"}],"args_string":"(node : String) : Bool","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L40","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring.cr#L40","def":{"name":"remove","args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"if @nodes.all? do |e|\n  e != node\nend\n  return false\nend\n@nodes.delete(node)\n@items = generate_items(@nodes, @replicate)\ntrue\n"}}],"macros":[],"types":[]},{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing/Item","path":"HashRing/Item.html","kind":"struct","full_name":"HashRing::Item","name":"Item","abstract":false,"superclass":{"html_id":"github.com/TobiasGSmollett/hash_ring/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"github.com/TobiasGSmollett/hash_ring/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"github.com/TobiasGSmollett/hash_ring/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"github.com/TobiasGSmollett/hash_ring/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"github.com/TobiasGSmollett/hash_ring/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"hash_ring/item.cr","line_number":4,"url":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr"}],"repository_name":"github.com/TobiasGSmollett/hash_ring","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"github.com/TobiasGSmollett/hash_ring/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing","kind":"module","full_name":"HashRing","name":"HashRing"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(node,replica:Int32)-class-method","html_id":"new(node,replica:Int32)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":""},{"name":"replica","doc":null,"default_value":"","external_name":"replica","restriction":"Int32"}],"args_string":"(node, replica : Int32)","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L10","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L10","def":{"name":"new","args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":""},{"name":"replica","doc":null,"default_value":"","external_name":"replica","restriction":"Int32"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(node, replica)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"(other:self)-instance-method","html_id":"(other:self)-instance-method","name":"<=>","doc":null,"summary":null,"abstract":false,"args":[{"name":"other","doc":null,"default_value":"","external_name":"other","restriction":"self"}],"args_string":"(other : self)","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L14","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L14","def":{"name":"<=>","args":[{"name":"other","doc":null,"default_value":"","external_name":"other","restriction":"self"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@hash <=> other.hash"}},{"id":"hash:UInt64-instance-method","html_id":"hash:UInt64-instance-method","name":"hash","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : UInt64","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L7","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L7","def":{"name":"hash","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"UInt64","visibility":"Public","body":"@hash"}},{"id":"node:String-instance-method","html_id":"node:String-instance-method","name":"node","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L8","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/item.cr#L8","def":{"name":"node","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@node"}}],"macros":[],"types":[]},{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing/Utils","path":"HashRing/Utils.html","kind":"module","full_name":"HashRing::Utils","name":"Utils","abstract":false,"superclass":null,"ancestors":[{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing","kind":"module","full_name":"HashRing","name":"HashRing"}],"locations":[{"filename":"hash_ring/utils.cr","line_number":4,"url":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/utils.cr"}],"repository_name":"github.com/TobiasGSmollett/hash_ring","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing","kind":"module","full_name":"HashRing","name":"HashRing"}],"extended_modules":[{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing/Utils","kind":"module","full_name":"HashRing::Utils","name":"Utils"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/TobiasGSmollett/hash_ring/HashRing","kind":"module","full_name":"HashRing","name":"HashRing"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"hash(key)-instance-method","html_id":"hash(key)-instance-method","name":"hash","doc":null,"summary":null,"abstract":false,"args":[{"name":"key","doc":null,"default_value":"","external_name":"key","restriction":""}],"args_string":"(key)","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/utils.cr#L8","source_link":"https://github.com/TobiasGSmollett/hash_ring/blob/761a351b4c994645663549d82131903e37f257cc/src/hash_ring/utils.cr#L8","def":{"name":"hash","args":[{"name":"key","doc":null,"default_value":"","external_name":"key","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"return (Digest::MD5.hexdigest(key))[16, 16].to_u64(16)"}}],"macros":[],"types":[]}]}]}}